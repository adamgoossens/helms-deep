- tags:
  - console
  block:
  - name: console - create secret for custom providers login page
    kubernetes.core.k8s:
      definition:
        apiVersion: v1
        kind: Secret
        metadata:
          name: providers-template
          namespace: openshift-config
        data:
          "providers.html": "{{ lookup('file', 'bootstrap-templates/console/providers-template.html') | b64encode }}"

  - name: console - update cluster oauths to use custom provider page
    kubernetes.core.k8s:
      definition:
        apiVersion: config.openshift.io/v1
        kind: OAuth
        metadata:
          name: cluster
        spec:
          templates:
            providerSelection:
              name: providers-template
        
