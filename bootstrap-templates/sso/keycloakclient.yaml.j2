apiVersion: keycloak.org/v1alpha1
kind: KeycloakClient
metadata:
  name: supervisor-cluster-client
  namespace: helms-deep-sso
  labels:
    app: sso
spec:
  realmSelector:
    matchLabels:
      realm: helms-deep
      app: sso
  client:
    clientId: helms-deep-supervisor
    name: "HELMS DEEP Supervisor Cluster"
    enabled: true
    clientAuthenticatorType: client-secret
    publicClient: false
    redirectUris:
      - 'https://console-openshift-console.apps.{{ cluster_basedomain }}/*'
      - 'https://api.{{ cluster_basedomain }}/*'
      - 'https://oauth-openshift.apps.{{ cluster_basedomain }}/*'
    rootUrl: 'https://console-openshift-console.apps.{{ cluster_basedomain }}/'
    protocol: openid-connect
    standardFlowEnabled: true
    protocolMappers:
      - protocol: openid-connect
        name: username
        protocolMapper: oidc-usermodel-property-mapper
        config:
          "userinfo.token.claim": 'true'
          "user.attribute": 'username'
          "id.token.claim": 'true'
          "access.token.claim": 'true'
          "claim.name": 'preferred_username'
          "jsonType.label": "String"
        consentRequired: false
      - protocol: openid-connect
        protocolMapper: 'oidc-full-name-mapper'
        name: 'full name'
        consentRequired: false
        config:
          "userinfo.token.claim": 'true'
          "id.token.claim": 'true'
          "access.token.claim": 'true'
      - protocol: openid-connect
        protocolMapper: 'oidc-usermodel-property-mapper'
        consentRequired: false
        config:
          "userinfo.token.claim": 'true'
          "user.attribute": 'email'
          "id.token.claim": 'true'
          "access.token.claim": 'true'
          "claim.name": 'email'
          "jsonType.label": "String"
